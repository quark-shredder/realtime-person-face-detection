# Real-time Object Detection Configuration

camera:
  device_id: 0
  width: 640
  height: 480
  fps: 30
  buffer_size: 4  # Increased for better frame management

object_detector:
  enabled: true
  model: "yolox_tiny"
  input_size: 640
  confidence_threshold: 0.40  # Balanced threshold for YOLOX-Tiny
  nms_threshold: 0.45
  max_detections: 50
  device: "mps"  # mps, cuda, or cpu
  model_path: "data/models/yolox_tiny.pth"

face_detector:
  enabled: true
  model: "mediapipe"
  min_detection_confidence: 0.5
  model_selection: 0  # 0=short range (2m), 1=full range (5m)

face_recognition:
  enabled: true
  model_pack: "buffalo_s"  # buffalo_l, buffalo_s (using smaller for speed)
  embedding_model: "mobilefacenet"  # mobilefacenet, arcface_r50
  similarity_threshold: 0.50
  enrollment_samples: 15
  recognition_interval: 30  # frames between re-recognition per track
  enrolled_faces_path: "data/enrolled"
  ctx_id: -1  # -1 for CPU, 0 for GPU (CPU faster on MPS for InsightFace)
  det_size: 128  # Detection size (128 for speed, 256 for accuracy)

tracking:
  enabled: true
  tracker_type: "bytetrack"  # bytetrack, sort, centroid
  track_thresh: 0.5
  track_buffer: 30
  match_thresh: 0.8
  min_box_area: 100

performance:
  target_fps: 30
  num_threads: 3  # capture, inference, recognition
  enable_profiling: false
  adaptive_quality: true  # drop features if CPU overloaded

visualization:
  show_fps: true
  show_latency: true
  show_track_ids: true
  show_confidence: true
  box_thickness: 2
  font_scale: 0.6
  colors:
    object: [0, 255, 0]      # green
    face: [255, 165, 0]      # orange
    recognized: [0, 255, 255] # yellow
    unknown: [128, 128, 128] # gray

recording:
  save_path: "logs/recordings"
  video_codec: "mp4v"
  image_format: "jpg"

logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  log_file: "logs/app.log"
  rotation: "10 MB"

captioning:
  enabled: false
  server_url: "http://localhost:8080"
  prompt: "Describe what you see in one sentence."
  interval_seconds: 0.5
  jpeg_quality: 80
  max_tokens: 100
  timeout_seconds: 8.0

web_ui:
  enabled: false  # Set true for browser UI, false for OpenCV window
  host: "127.0.0.1"
  port: 8000
  frame_quality: 80  # JPEG quality for browser streaming (1-100)
  stream_fps: 15
  send_overlays: true  # Show detection boxes in browser
  # NOTE: When web_ui is enabled, keyboard shortcuts (F/O/C/I/P/S/R) are disabled.
  # Use browser UI controls instead. OpenCV window is hidden in web mode.
